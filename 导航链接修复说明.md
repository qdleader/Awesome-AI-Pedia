# 导航链接404问题修复说明

## 问题描述

首页顶部导航链接(从Cursor之后的所有链接)点击后,二级、三级页面都显示404错误。

## 问题原因

在 `docs/ai/` 目录下,所有的内容文件夹都是**符号链接**(symlinks),指向项目根目录下的实际文件夹:

```bash
docs/ai/mcp -> ../../mcp
docs/ai/cursor -> ../../cursor
docs/ai/prompt -> ../../prompt
# ... 等等
```

VitePress在构建静态网站时,**不会跟随符号链接**,导致这些目录的内容没有被正确复制到构建输出中,从而产生404错误。

## 解决方案

### 1. 创建符号链接复制脚本

创建了 `scripts/copy-symlinks.js` 脚本,该脚本会:
- 检测 `docs/ai/` 目录下的所有符号链接
- 将符号链接指向的实际目录内容复制到 `docs/ai/` 中
- 将符号链接替换为真实的目录和文件

### 2. 修改构建流程

在 `package.json` 中添加了 `prebuild` 钩子:

```json
{
  "scripts": {
    "prebuild": "node scripts/copy-symlinks.js",
    "build": "vitepress build docs"
  }
}
```

这样每次运行 `npm run build` 时,会自动先执行符号链接复制脚本。

## 符号链接映射关系

| 符号链接名称 | 实际目录 |
|------------|---------|
| `bu-shu-ai` | `部署ai` |
| `chang-yong-skills` | `常用skills` |
| `claudecode` | `claudeCode` |
| `cursor` | `cursor` |
| `hao-de-rules` | `好的rules` |
| `kai-fa-ai-ying-yong` | `开发ai应用相关问题` |
| `mcp` | `mcp` |
| `prompt` | `prompt` |
| `rules` | `rules` |
| `shi-yong-ai-ji-qiao` | `使用ai技巧` |
| `skills` | `skills` |

## 验证结果

✅ 所有顶部导航链接正常工作
✅ 二级页面(分类索引页)正常显示
✅ 三级页面(文章详情页)正常显示
✅ 侧边栏导航正常工作

测试的链接包括:
- Cursor → Cursor文章
- MCP → MCP文章
- Prompt → Prompt文章

## 使用说明

### 开发环境

开发时可以继续使用符号链接,不需要额外操作:

```bash
npm run dev
```

### 构建部署

构建时会自动复制符号链接内容:

```bash
npm run build
```

### 手动复制符号链接

如果需要手动复制符号链接内容:

```bash
node scripts/copy-symlinks.js
```

## 注意事项

1. **内容同步**: 由于符号链接被替换为真实目录,如果修改了根目录下的原始文件,需要重新运行 `copy-symlinks.js` 脚本来同步到 `docs/ai/` 目录

2. **Git管理**: `docs/ai/` 下的真实目录内容应该被提交到Git,以确保部署时有完整的文件

3. **构建前自动同步**: 每次构建前都会自动运行复制脚本,确保内容是最新的

## 相关文件

- `scripts/copy-symlinks.js` - 符号链接复制脚本
- `package.json` - 添加了prebuild钩子
- `docs/.vitepress/utils/sidebar.ts` - 侧边栏生成逻辑
- `docs/.vitepress/config.ts` - VitePress配置文件
